extends layout/default

block content
    .blogs-container
        .container
            h1 Blog de Motocicletas

            .blogs-intro
                p Descubre los últimos artículos, consejos y novedades del mundo de las motocicletas

            .filtros-blogs
                .filtro-categoria
                    label(for="categoria-blog") Categoría
                    select#categoria-blog
                        option(value="") Todas las Categorías
                        option(value="mantenimiento") Mantenimiento
                        option(value="consejos") Consejos de Conducción
                        option(value="novedades") Novedades
                        option(value="tecnica") Técnica de Motocicletas

                .filtro-busqueda
                    input(type="text" placeholder="Buscar artículos...")
                    button.btn.btn--small Buscar

            .listado-blogs
                each blog in blogs
                    .blog-card
                        .blog-imagen
                            img(src=blog.imagen, alt=blog.titulo)
                        .blog-contenido
                            h2= blog.titulo
                            .blog-meta
                                span.fecha= blog.fecha
                                span.categoria= blog.categoria
                            p.blog-extracto= blog.extracto
                            a.btn.btn--small(href=`/blogs/${blog.slug}`) Leer más

            .paginacion
                button.btn.btn--secondary Anterior
                span Página 1 de 5
                button.btn.btn--secondary Siguiente

    script.
        document.addEventListener('DOMContentLoaded', () => {
            const categoriaSelect = document.getElementById('categoria-blog');
            const busquedaInput = document.querySelector('.filtro-busqueda input');
            const buscarBtn = document.querySelector('.filtro-busqueda button');
            const listadoBlogs = document.querySelector('.listado-blogs');

            function filtrarBlogs() {
                const categoria = categoriaSelect.value;
                const busqueda = busquedaInput.value.toLowerCase();

                fetch(`/api/blogs?categoria=${categoria}&busqueda=${busqueda}`)
                    .then(response => response.json())
                    .then(blogs => {
                        // Limpiar listado actual
                        listadoBlogs.innerHTML = '';

                        // Renderizar blogs filtrados
                        blogs.forEach(blog => {
                            const blogCard = document.createElement('div');
                            blogCard.classList.add('blog-card');
                            blogCard.innerHTML = `
                                <div class="blog-imagen">
                                    <img src="${blog.imagen}" alt="${blog.titulo}">
                                </div>
                                <div class="blog-contenido">
                                    <h2>${blog.titulo}</h2>
                                    <div class="blog-meta">
                                        <span class="fecha">${blog.fecha}</span>
                                        <span class="categoria">${blog.categoria}</span>
                                    </div>
                                    <p class="blog-extracto">${blog.extracto}</p>
                                    <a href="/blogs/${blog.slug}" class="btn btn--small">Leer más</a>
                                </div>
                            `;
                            listadoBlogs.appendChild(blogCard);
                        });
                    })
                    .catch(error => console.error('Error al filtrar blogs:', error));
            }

            categoriaSelect.addEventListener('change', filtrarBlogs);
            buscarBtn.addEventListener('click', filtrarBlogs);
        });